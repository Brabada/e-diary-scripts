<h1 id="introduction">Скрипты для исправления успеваемости в школе</h1>

Данный репозиторий содержит файл со скриптами `scripts.py`, которые написаны для исправления
метрик успеваемости в электронном дневнике и служит учебным целям (no pun intended). 

Сам код электронного дневника доступен по ссылке: https://github.com/devmanorg/e-diary/

Перед запуском скрипта, нужно развернуть у себя сайт электронного дневника и создать/получить файл с БД. 
Как это сделать указано [здесь](https://github.com/devmanorg/e-diary/tree/master#%D0%B7%D0%B0%D0%BF%D1%83%D1%81%D0%BA).

Файл `scripts.py` содержит следующие скрипты:
- **fix_all(kid_name, subject)** - по переданной строке с ФИО/ФИ ученика `kid_name` и предмету `subject`, исправляет оценки
ученика ниже четвёрок на пятерки в электронном дневнике, удаляет все замечания и при каждом запуске выдаёт одну похвалу по
предмету `subject`. Похвала выдается за последний урок по предмету, если за этот урок уже есть похвала, то по предыдущему.
- **get_schoolkid(kid_name)** - по переданной строке c ФИО/ФИ возвращает `<QuerySet> Schoolkid`,
если по данному `kid_name` есть ученики.
- **fix_marks(kid_name)** - по переданной строке с ФИО/ФИ исправляет все плохие оценки ученика `kid_name`
(ниже 4) на пятёрки.
- **remove_chastisments(kid_name)** - по переданной строке c ФИО/ФИ удаляет все замечания по ученику `kid_name`.
- **create_commendation(kid_name, subject)** - по переданной строке с ФИО/ФИ ученика `kid_name` и строке с названием предмета
`subject` добавляет похвалу в карточку ученика `kid_name` по последнему проведенному уроку по предмету 
`subject`. Если за этот предмет уже была отметка с похвалой, то выдает похвалу по следующему прошедшему более раннее уроку.

**fix_all(kid_name, subject)** является базовым скриптом, который рекомендуется исполнять. Все остальные скрипты необходимы,
если вы хотите проверить наличие ученика в БД, изменить оценки, убрать замечания и добавить похвалу.

Далее будут описаны различные примеры использования (use cases).

1. [Исправить оценки](#fix_marks)
2. [Помочь друзьям](#help_friends)
3. [Многократное использование](#multiple_use)
4. [Ошибки ввода](#input_errors)
5. [Что за проект?](#project_purpose)
6. [Хочу такой же!](#want_project)

<h2 id="fix_marks">1. Исправить оценки</h2>
**Use-case**: 
Школьник Ваня хочет исправить свои оценки.
Сайт электронного дневника уже давно настроен и работает на отдельном сервере. 
У Вани есть к нему доступ. Он уже научился скачивать и загружать файлы на сервер. 
Также он умеет открывать консоль и запускать там команды.

**Решение**:

1. Добавить файл `scripts.py` в папку с файлом `manage.py`.
2. Запустить shell для доступа к серверу с электронным дневником:
```shell
$ cd "Путь/до/manage.py"
$ python manage.py shell
Python 3.10.6 (tags/v3.10.6:9c7b4bd, Aug  1 2022, 21:53:49) [MSC v.1932 64 bit (AMD64)] on win32
Type "help", "copyright", "credits" or "license" for more information.                          
(InteractiveConsole)                                                                            
>>> 
```
3. Загрузить скрипты из scripts.py на сервер:
```shell
>>> from scripts import *
```

4. Запустить команду `fix_all()`, вставив свою фамилию с именем и название предмета через запятую. 

ФИО и название предмета нужно обернуть в кавычки.

```shell
>>> fix_all("Фролов Иван", "Музыка")
```

**Примечание**: ФИО/ФИ ученика должны быть набраны с заглавной буквы в порядке "Фамилия Имя" или "Фамилия Имя Отчество".
Если по ФИО/ФИ находится несколько учеников или не найдено ни одного скрипт сообщит об этом и завершит работу.

Название предмета так же должно начинаться с заглавной буквы. В случае если скрипт не найдёт данный предмет, то сообщит об этом
и завершит работу.

Пример использования:
```shell
$ cd "c/programming/e-diary"
$ python manage.py shell
Python 3.10.6 (tags/v3.10.6:9c7b4bd, Aug  1 2022, 21:53:49) [MSC v.1932 64 bit (AMD64)] on win32
Type "help", "copyright", "credits" or "license" for more information.                          
(InteractiveConsole)
>>> from scripts import *
>>> fix_all("Фролов Иван", "Музыка")
```

<h2 id="help_friends">2. Помочь друзьям</h2>

**Use-case**: Из README Ваня узнаёт, как запустить скрипт для своего друга.

**Решение**:
1. Повторить шаги 1-3 из [Исправить оценки](#fix_marks).
2. Запустить команду `fix_all()`, вставив фамилию и имя друга и название нужного предмета через запятую.

```shell
>>> fix_all("Фокин Тарас", "Физкультура")
```

<h2 id="multiple_use">3. Многократное использование</h2>
**Use-case**:

Проходит месяц, а то и два. В дневнике Ваня снова набрал себе троек и теперь жаждет поднять успеваемость. Юный хакер вспоминает про ваш скрипт. Он находит ссылку на GitHub и следует инструкциям, как и в прошлый раз.

Отличие этого сценария в том, что скрипт запускается многократно в течение учебного года. Каждый раз исправляются плохие оценки, удаляются жалобы и добавляется похвала. При этом важно, чтобы записи в дневнике выглядели реалистично: текст похвалы менялся от запуска к запуску, и записи не накапливались у одного единственного урока.

**Решение**:

Скрипт `fix_all()` при каждом вызове помимо корректировки оценок и удаления замечаний, если это необходимо, так же добавляет
по новой похвале по последнему уроку указанного предмета. 
При этом если за последний урок уже есть похвала, то идёт проверка наличия похвалы
за предыдущий урок и т.д. пока не найдётся урок без похвалы.

Поэтому для многократного использования достаточно повторить шаги из [Исправить оценки](#fix-marks)

<h2 id="input_errors">4. Ошибки ввода</h2>
**Use-case**:
Школьник Ваня не так хорош в программировании и с трейсбеками работать пока не умеет. Они его шокируют и пугают, поэтому читать их он вряд ли будет.
Надо позаботиться о том, чтобы в случае ошибки скрипт понятным образом сообщил ему в чём дело и как это исправить.

**Решение**:

Скрипт fix_all(kid_name, subject) обрабатывает следующие ошибки:
1. По переданному ФИО/ФИ ученика `kid_name` не находится ученик в БД. Завершение скрипта.

Вывод:
```shell
>>>Ошибка! По запросу {kid_name} никого не найдено.
Возможно вы допустили опечатку.
Название должно быть в формате ФИО или ФИ.
```

Причина:
- Переданного ученика нет в БД;
- В ФИО/ФИ опечатка;
- В ФИО/ФИ опечатка или не учтён регистр и порядок слов. Все слова должны начинаться с заглавной буквы.
слова должны передаваться в указанном порядке "Фамилия-Имя-Отчество". Пример: "Фролов Иван Сергеевич".

2. Переданные ФИО/ФИ пустые. Завершение скрипта.

```shell
>>>Строка с ФИО не должна быть пустой.
```

Причина:
- Была передана пустая строка в скрипт. Пример: `fix_all("", "Музыка")`

3. По переданному ФИО/ФИ было найдено несколько учеников. Завершение скрипта.

Вывод:
```shell
>>>Ошибка! По запросу {kid_name} найдено несколько результатов. Уточните имя.
```

Причина:
- Было передано только имя или по данному ФИ есть несколько учеников. Нужно добавить отчество.

4. Переданное название предмета не найдено в БД. Завершение скрипта.

Вывод:
```shell
>>>По предмету {subject} нет результатов.
Возможно вы допустили опечатку в названии предмета.
```

Причина:
- Передано название предмета с ошибкой;
- Переданный предмет отсутствует в перечне существующих предметов. Нужно свериться со списком предметов
в электронном дневнике.

<h2 id="project_purpose">5. Что за проект?</h2>

**Use-case**:

Другой программист случайно наткнулся на ваш репозиторий на GitHub. У него пока нет желания вникать в код и делать что-либо. Он хочет понять где оказался и как это относится к нему.

Overall по проекту описан во [Вступлении](#introduction).

<h2 id=want_project>6. Хочу такой же!</h2>
**Use-case**:
Другой программист, уже знакомый с проектом, хочет развернуть код у себя и слегка "доработать напильником".

Overall по проекту описан во [Вступлении](#introduction).

По вопросам развёртывания сайта и БД, пользоваться https://github.com/devmanorg/e-diary.